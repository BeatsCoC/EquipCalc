<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8" />
    <title>Equipment & Liga Auswahl</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: auto;
            padding: 20px;
        }
        label {
            display: block;
            margin-top: 10px;
        }
        input, select {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #999;
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <form onsubmit="return false;">
        <label for="epic-equipment">Number Epic Equipments (0–10):</label>
        <input type="number" id="epic-equipment" name="epic-equipment" min="0" max="10" />

        <label for="standard-equipment">Number Common Equipments (0–20):</label>
        <input type="number" id="standard-equipment" name="standard-equipment" min="0" max="20" />

        <label for="liga">Your League for starbonus:</label>
        <select id="liga" name="liga">
            <option value="" disabled selected>please select</option>
            <option value="no starbonus">no starbonus</option>
            <option value="Bronze 3">Bronze 3</option>
            <option value="Bronze 2">Bronze 2</option>
            <option value="Bronze 1">Bronze 1</option>
            <option value="Silber 3">Silver 3</option>
            <option value="Silber 2">Silver 2</option>
            <option value="Silber 1">Silver 1</option>
            <option value="Gold 3">Gold 3</option>
            <option value="Gold 2">Gold 2</option>
            <option value="Gold 1">Gold 1</option>
            <option value="Kristall 3">Crystal 3</option>
            <option value="Kristall 2">Crystal 2</option>
            <option value="Kristall 1">Crystal 1</option>
            <option value="Meister 3">Master 3</option>
            <option value="Meister 2">Master 2</option>
            <option value="Meister 1">Master 1</option>
            <option value="Champion 3">Champion 3</option>
            <option value="Champion 2">Champion 2</option>
            <option value="Champion 1">Champion 1</option>
            <option value="Titan 3">Titan 3</option>
            <option value="Titan 2">Titan 2</option>
            <option value="Titan 1">Titan 1</option>
            <option value="Legende">Legend</option>
        </select>

        <label for="winrate">CW winrate:</label>
        <select id="winrate" name="winrate">
            <option value="" disabled selected>please select</option>
            <option value="0%">0%</option>
            <option value="5%">5%</option>
            <option value="10%">10%</option>
            <option value="15%">15%</option>
            <option value="20%">20%</option>
            <option value="25%">25%</option>
            <option value="30%">30%</option>
            <option value="35%">35%</option>
            <option value="40%">40%</option>
            <option value="45%">45%</option>
            <option value="50%">50%</option>
            <option value="55%">55%</option>
            <option value="60%">60%</option>
            <option value="65%">65%</option>
            <option value="70%">70%</option>
            <option value="75%">75%</option>
            <option value="80%">80%</option>
            <option value="85%">85%</option>
            <option value="90%">90%</option>
            <option value="95%">95%</option>
            <option value="100%">100%</option>
        </select>

        <label for="townhall">Townhall Level:</label>
        <select id="townhall" name="townhall">
            <option value="" disabled selected>please select</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
            <option value="11">11</option>
            <option value="12">12</option>
            <option value="13">13</option>
            <option value="14">14</option>
            <option value="15">15</option>
            <option value="16">16</option>
            <option value="17">17</option>
        </select>
    </form>

    <h2>Calculations</h2>
    <table id="berechnung">
        <tr><th></th><th>Shiny</th><th>Glowy</th><th>Starry</th></tr>
        <tr><td>Total Cost</td><td id="total-shiny"></td><td id="total-glowy"></td><td id="total-starry"></td></tr>
        <tr><td>Starbonus</td><td id="bonus-shiny"></td><td id="bonus-glowy"></td><td>0</td></tr>
        <tr><td>CW bonus per hit</td><td id="cwbonus-shiny"></td><td id="cwbonus-glowy"></td><td id="cwbonus-starry"></td></tr>
        <tr><td>Number of days needed</td><td></td><td></td><td></td></tr>
        <tr><td>Free trader gifts weekly</td><td>0</td><td><select id="freetrader-gifts-glowy" name="freetrader-gifts-glowy">
        <option value="0">0</option>
        <option value="10">10</option>
      </select></td><td>0</td></tr>
        <tr><td>Number of days needed</td><td></td><td></td><td></td></tr>
        <tr><td>Raid medals trader weekly</td><td><select id="raid-medals-shiny" name="raid-medals-shiny">
        <option value="0">0</option>
        <option value="500">500</option>
        <option value="1000">1000</option>
      </select></td><td>
      <select id="raid-medals-glowy" name="raid-medals-glowy">
        <option value="0">0</option>
        <option value="50">50</option>
        <option value="100">100</option>
      </select></td><td>
      <select id="raid-medals-starry" name="raid-medals-starry">
        <option value="0">0</option>
        <option value="5">5</option>
        <option value="10">10</option>
      </select></td></tr>
        <tr><td>Number of days needed</td><td></td><td></td><td></td></tr>
    </table>

    <h2>Cost per Equipment</h2>
    <table>
        <tr><th></th><th>Shiny</th><th>Glowy</th><th>Starry</th></tr>
        <tr><td>Common Equipment</td><td>27260</td><td>1920</td><td>0</td></tr>
        <tr><td>Epic Equipment</td><td>56060</td><td>3720</td><td>480</td></tr>
    </table>

    <h2>Starbonus</h2>
    <table id="starbonus-table">
        <tr><th>League</th><th>Shiny</th><th>Glowy</th></tr>
        <tr><td>no starbonus</td><td>0</td><td>0</td></tr>
        <tr><td>Bronze 3</td><td>125</td><td>6</td></tr>
        <tr><td>Bronze 2</td><td>175</td><td>7</td></tr>
        <tr><td>Bronze 1</td><td>175</td><td>8</td></tr>
        <tr><td>Silver 3</td><td>200</td><td>9</td></tr>
        <tr><td>Silver 2</td><td>250</td><td>10</td></tr>
        <tr><td>Silver 1</td><td>275</td><td>11</td></tr>
        <tr><td>Gold 3</td><td>300</td><td>12</td></tr>
        <tr><td>Gold 2</td><td>325</td><td>14</td></tr>
        <tr><td>Gold 1</td><td>350</td><td>16</td></tr>
        <tr><td>Crystal 3</td><td>375</td><td>18</td></tr>
        <tr><td>Crystal 2</td><td>400</td><td>20</td></tr>
        <tr><td>Crystal 1</td><td>425</td><td>22</td></tr>
        <tr><td>Master 3</td><td>450</td><td>24</td></tr>
        <tr><td>Master 2</td><td>500</td><td>26</td></tr>
        <tr><td>Master 1</td><td>525</td><td>28</td></tr>
        <tr><td>Champion 3</td><td>550</td><td>30</td></tr>
        <tr><td>Champion 2</td><td>625</td><td>34</td></tr>
        <tr><td>Champion 1</td><td>700</td><td>38</td></tr>
        <tr><td>Titan 3</td><td>775</td><td>42</td></tr>
        <tr><td>Titan 2</td><td>850</td><td>46</td></tr>
        <tr><td>Titan 1</td><td>925</td><td>50</td></tr>
        <tr><td>Legend</td><td>1000</td><td>54</td></tr>
    </table>

    <h2>CW Winrate Ores</h2>
    <table id="cw-ertrag">
        <tr><th>CW Winrate</th><th>Shiny</th><th>Glowy</th><th>Starry</th></tr>
        <tr><td>no cw</td><td>0</td><td>0</td><td>0</td></tr>
        <tr><td>0%</td><td></td><td></td><td></td></tr>
        <tr><td>5%</td><td></td><td></td><td></td></tr>
        <tr><td>10%</td><td></td><td></td><td></td></tr>
        <tr><td>15%</td><td></td><td></td><td></td></tr>
        <tr><td>20%</td><td></td><td></td><td></td></tr>
        <tr><td>25%</td><td></td><td></td><td></td></tr>
        <tr><td>30%</td><td></td><td></td><td></td></tr>
        <tr><td>35%</td><td></td><td></td><td></td></tr>
        <tr><td>40%</td><td></td><td></td><td></td></tr>
        <tr><td>45%</td><td></td><td></td><td></td></tr>
        <tr><td>50%</td><td></td><td></td><td></td></tr>
        <tr><td>55%</td><td></td><td></td><td></td></tr>
        <tr><td>60%</td><td></td><td></td><td></td></tr>
        <tr><td>65%</td><td></td><td></td><td></td></tr>
        <tr><td>70%</td><td></td><td></td><td></td></tr>
        <tr><td>75%</td><td></td><td></td><td></td></tr>
        <tr><td>80%</td><td></td><td></td><td></td></tr>
        <tr><td>85%</td><td></td><td></td><td></td></tr>
        <tr><td>90%</td><td></td><td></td><td></td></tr>
        <tr><td>95%</td><td></td><td></td><td></td></tr>
        <tr><td>100%</td><td id="cw100-shiny"></td><td id="cw100-glowy"></td><td id="cw100-starry"></td></tr>
    </table>

    <h2>CW Ores per Townhall</h2>
    <table id="erze-table">
        <tr><th>Townhall</th><th>Shiny</th><th>Glowy</th><th>Starry</th></tr>
        <tr><td>8</td><td>380</td><td>15</td><td>0</td></tr>
        <tr><td>9</td><td>410</td><td>18</td><td>0</td></tr>
        <tr><td>10</td><td>460</td><td>21</td><td>3</td></tr>
        <tr><td>11</td><td>560</td><td>24</td><td>3</td></tr>
        <tr><td>12</td><td>610</td><td>27</td><td>4</td></tr>
        <tr><td>13</td><td>710</td><td>30</td><td>4</td></tr>
        <tr><td>14</td><td>810</td><td>33</td><td>4</td></tr>
        <tr><td>15</td><td>960</td><td>36</td><td>5</td></tr>
        <tr><td>16</td><td>1110</td><td>39</td><td>6</td></tr>
        <tr><td>17</td><td>1110</td><td>39</td><td>6</td></tr>
    </table>

<script>
function calculateCosts() {
  console.log("calculateCosts läuft");
    const epic = parseInt(document.getElementById('epic-equipment')?.value) || 0;
    const standard = parseInt(document.getElementById('standard-equipment')?.value) || 0;
    const shiny = standard * 27260 + epic * 56060;
    const glowy = standard * 1920 + epic * 3720;
    const starry = standard * 0 + epic * 480;
    document.getElementById("total-shiny").textContent = shiny;
    document.getElementById("total-glowy").textContent = glowy;
    document.getElementById("total-starry").textContent = starry;

    // Berechnung total cost + starbonus + cw bonus per hit
    const bonusShiny = parseInt(document.getElementById("bonus-shiny")?.textContent) || 0;
    const bonusGlowy = parseInt(document.getElementById("bonus-glowy")?.textContent) || 0;
    const cwShiny = parseInt(document.getElementById("cwbonus-shiny")?.textContent) || 0;
    const cwGlowy = parseInt(document.getElementById("cwbonus-glowy")?.textContent) || 0;
    const cwStarry = parseInt(document.getElementById("cwbonus-starry")?.textContent) || 0;

    // Beispiel: number of days needed könnte berechnet werden durch shiny / (starbonus + cw pro tag etc.)
    // Platzhalter für spätere Berechnung
  updateDays1();
} 

function updateStarbonus() {
    const liga = document.getElementById("liga")?.value;
    const rows = document.querySelectorAll("#starbonus-table tr");
    for (const row of rows) {
        const cells = row.querySelectorAll("td");
        if (cells.length && cells[0].textContent === liga) {
            document.getElementById("bonus-shiny").textContent = cells[1].textContent;
            document.getElementById("bonus-glowy").textContent = cells[2].textContent;
        }
    }
}

function updateCW100Ertrag() {
  console.log("updateCW100Ertrag läuft");
// 100%-Zeile mit Werten aus Erze pro Rathaus befüllen
const townhall = document.getElementById("townhall")?.value;
const erzeRows = document.querySelectorAll("#erze-table tr");

for (let i = 1; i < erzeRows.length; i++) {
    const cells = erzeRows[i].children;
    if (cells.length && cells[0].textContent.trim() === townhall) {
        document.getElementById("cw100-shiny").textContent = cells[1].textContent;
        document.getElementById("cw100-glowy").textContent = cells[2].textContent;
        document.getElementById("cw100-starry").textContent = cells[3].textContent;
        break;
    }
}  
// Werte aus der 100%-Zeile holen
const cw100Shiny = parseInt(document.getElementById("cw100-shiny")?.textContent) || 0;
const cw100Glowy = parseInt(document.getElementById("cw100-glowy")?.textContent) || 0;
const cw100Starry = parseInt(document.getElementById("cw100-starry")?.textContent) || 0;

// ✅ richtig deklarieren
const rows = document.querySelectorAll("#cw-ertrag tr");
  
// 0%-Zeile
rows.forEach(row => {
    const cells = row.querySelectorAll("td");
    if (cells.length && cells[0].textContent.trim() === "0%") {
        cells[1].textContent = Math.floor(cw100Shiny / 2);
        cells[2].textContent = Math.floor(cw100Glowy / 2);
        cells[3].textContent = Math.floor(cw100Starry / 2);
    }
});

  
// CW-Werte für 5–95 % berechnen
rows.forEach(row => {
    const cells = row.querySelectorAll("td");
    if (cells.length) {
        const label = cells[0].textContent.trim();
        const match = label.match(/^(\d+)%$/);
        if (match) {
            const winrate = parseInt(match[1]) / 100;
            if (winrate > 0 && winrate < 1) {
                cells[1].textContent = Math.round(cw100Shiny * (0.5 + 0.5 * winrate));
                cells[2].textContent = Math.round(cw100Glowy * (0.5 + 0.5 * winrate));
                cells[3].textContent = Math.round(cw100Starry * (0.5 + 0.5 * winrate));
            }
        }
    }
});
  calculateCosts();
  updateDays1();
}
  //CW Bonus per Hit ausfüllen
  function updateCWBonusFromTable() {
  const winrate = document.getElementById("winrate")?.value;
  if (!winrate) return; // Keine Winrate gewählt, nichts machen

  const rows = document.querySelectorAll("#cw-ertrag tr");
  for (const row of rows) {
    const cells = row.querySelectorAll("td");
    if (cells.length && cells[0].textContent.trim() === winrate) {
      document.getElementById("cwbonus-shiny").textContent = cells[1].textContent;
      document.getElementById("cwbonus-glowy").textContent = cells[2].textContent;
      document.getElementById("cwbonus-starry").textContent = cells[3].textContent;
      break;
    }
  }
}
  
   //Erste Number of Days needed Berechnung
   function updateDays1(){
    console.log("updateDays1 wird ausgeführt");
    const getValue = id => {
    const val = parseInt(document.getElementById(id)?.textContent);
    return isNaN(val) ? 0 : val;
  };  
  const totalShiny = getValue("total-shiny");
  const totalGlowy = getValue("total-glowy");
  const totalStarry = getValue("total-starry");

  const shinyBonusTotal1 = getValue("bonus-shiny") + getValue("cwbonus-shiny");
  const glowyBonusTotal1 = getValue("bonus-glowy") + getValue("cwbonus-glowy");
  const starryBonusTotal1 = getValue("bonus-starry") + getValue("cwbonus-starry");

  const shinyDays = shinyBonusTotal1 > 0 ? totalShiny / shinyBonusTotal1 : 0;
  const glowyDays = glowyBonusTotal1 > 0 ? totalGlowy / glowyBonusTotal1 : 0;
  const starryDays = starryBonusTotal1 > 0 ? totalStarry / starryBonusTotal1 : 0;

  // Werte in die 4. Zeile der Tabelle Berechnung eintragen
  const table = document.getElementById("berechnung");
  table.rows[4].cells[1].textContent = Math.round(shinyDays);
  table.rows[4].cells[2].textContent = Math.round(glowyDays);
  table.rows[4].cells[3].textContent = Math.round(starryDays);
}
  //Zweite Number of Days needed Berechnung
function updateDays2() {
  console.log("updateDays2 wird ausgeführt");
  
  const getValue = id => {
  const val = parseInt(document.getElementById(id)?.textContent);
  return isNaN(val) ? 0 : val;
  };

  const totalShiny = getValue("total-shiny");
  const totalGlowy = getValue("total-glowy");
  const totalStarry = getValue("total-starry");

  // Bonuswerte aus starbonus und cw bonus per hit
  const shinyBonusTotal = getValue("bonus-shiny") + getValue("cwbonus-shiny");
  const glowyBonusTotal = getValue("bonus-glowy") + getValue("cwbonus-glowy");
  const starryBonusTotal = getValue("bonus-starry") + getValue("cwbonus-starry");

  // Zusätzlich Wert aus freetrader gifts weekly (Dropdown) aus der 5. Zeile (Index 5), 3. Spalte (Index 2)
  const table = document.getElementById("berechnung");
  const freeTraderGiftsShiny = parseInt(table.rows[5].cells[1].textContent) || 0;  // Shiny-Spalte
  const freeTraderGiftsGlowy = parseInt(document.getElementById("freetrader-gifts-glowy")?.value) || 0; // Glowy Spalte
  const freeTraderGiftsStarry = parseInt(table.rows[5].cells[3].textContent) || 0; // Starry-Spalte

  // Gesamtbonus inklusive freetrader gifts, geteilt durch 7 weil nur 1x wöchentlich abholbar
  const shinySum = shinyBonusTotal + (freeTraderGiftsShiny / 7);
  const glowySum = glowyBonusTotal + (freeTraderGiftsGlowy / 7);
  const starrySum = starryBonusTotal + (freeTraderGiftsStarry / 7) ;

  // Berechnung der Tage (division durch Gesamtbonus)
  const shinyDays2 = shinySum > 0 ? totalShiny / shinySum : 0;
  const glowyDays2 = glowySum > 0 ? totalGlowy / glowySum : 0;
  const starryDays2 = starrySum > 0 ? totalStarry / starrySum : 0;
  
  // Werte in die 6. Zeile der Tabelle Berechnung eintragen (index 5 = "number of days needed" zweite Zeile)
  table.rows[6].cells[1].textContent = Math.round(shinyDays2);
  table.rows[6].cells[2].textContent = Math.round(glowyDays2);
  table.rows[6].cells[3].textContent = Math.round(starryDays2);
}

  //Dritte Number of Days needed Berechnung
function updateDays3() {
  console.log("updateDays3 wird ausgeführt");

  const getValue = id => {
    const val = parseInt(document.getElementById(id)?.textContent);
    return isNaN(val) ? 0 : val;
  };

  const totalShiny = getValue("total-shiny");
  const totalGlowy = getValue("total-glowy");
  const totalStarry = getValue("total-starry");

  // Bonuswerte aus starbonus und cw bonus per hit
  const shinyBonusTotal = getValue("bonus-shiny") + getValue("cwbonus-shiny");
  const glowyBonusTotal = getValue("bonus-glowy") + getValue("cwbonus-glowy");
  const starryBonusTotal = getValue("bonus-starry") + getValue("cwbonus-starry");

  // Werte aus freetrader gifts weekly (Dropdown oder Text)
  const freeTraderGiftsShiny = parseInt(document.getElementById("freetrader-gifts-shiny")?.value) || 0;
  const freeTraderGiftsGlowy = parseInt(document.getElementById("freetrader-gifts-glowy")?.value) || 0;
  const freeTraderGiftsStarry = parseInt(document.getElementById("freetrader-gifts-starry")?.value) || 0;

  // Werte aus raid medals trader weekly (Dropdown)
  const raidMedalsShiny = parseInt(document.getElementById("raid-medals-shiny")?.value) || 0;
  const raidMedalsGlowy = parseInt(document.getElementById("raid-medals-glowy")?.value) || 0;
  const raidMedalsStarry = parseInt(document.getElementById("raid-medals-starry")?.value) || 0;

  // Gesamtbonus inklusive freetrader gifts und raid medals trader, geteilt durch 7 weil nur 1x wöchentlich abholbar
  const shinySum = shinyBonusTotal + freeTraderGiftsShiny + (raidMedalsShiny / 7);
  const glowySum = glowyBonusTotal + freeTraderGiftsGlowy + (raidMedalsGlowy / 7);
  const starrySum = starryBonusTotal + freeTraderGiftsStarry + (raidMedalsStarry / 7);

  // Berechnung der Tage (division durch Gesamtbonus)
  const shinyDays3 = shinySum > 0 ? totalShiny / shinySum : 0;
  const glowyDays3 = glowySum > 0 ? totalGlowy / glowySum : 0;
  const starryDays3 = starrySum > 0 ? totalStarry / starrySum : 0;

  // Werte in die 8. Zeile eintragen
  const table = document.getElementById("berechnung");
  table.rows[8].cells[1].textContent = Math.round(shinyDays3);
  table.rows[8].cells[2].textContent = Math.round(glowyDays3);
  table.rows[8].cells[3].textContent = Math.round(starryDays3);
}



  
document.addEventListener("DOMContentLoaded", () => {
    document.getElementById("townhall")?.addEventListener("change", () => {
      updateCW100Ertrag();
      updateCWBonusFromTable();
      updateDays1();
      updateDays2();
      updateDays3();
    });
    document.getElementById("winrate")?.addEventListener("change", () => {
      updateCW100Ertrag();
      updateCWBonusFromTable();
      updateDays1();
      updateDays2();
      updateDays3();
     });
    document.getElementById("epic-equipment")?.addEventListener("input", calculateCosts);
    document.getElementById("standard-equipment")?.addEventListener("input", calculateCosts);
    document.getElementById("liga")?.addEventListener("change", () => {
      updateStarbonus();
      updateDays1();
      updateDays2();
      updateDays3();
    });
    document.getElementById("freetrader-gifts-glowy")?.addEventListener("change", () => {
      updateDays2();
      updateDays3();
    });
  document.getElementById("raid-medals-shiny")?.addEventListener("change", () => {
      updateDays2();
      updateDays3();
    });
  document.getElementById("raid-medals-glowy")?.addEventListener("change", () => {
      updateDays2();
      updateDays3();
    });
  document.getElementById("raid-medals-starry")?.addEventListener("change", () => {
      updateDays2();
      updateDays3();
    });
  
    calculateCosts();
    updateStarbonus();
    updateCW100Ertrag();
    updateDays1();
    updateDays2();
    updateDays3();
});
</script>
</body>
</html>
